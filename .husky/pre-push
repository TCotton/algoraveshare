#!/usr/bin/env sh
set -e

# Navigate to repository root
REPO_ROOT="$(git rev-parse --show-toplevel)"

echo "Running pre-push hooks..."

# Run backend pre-push
echo "→ Running backend checks..."
cd "$REPO_ROOT/apps/backend"
npm run lint:fix
npm run test:unit

# Run frontend pre-push
echo "→ Running frontend checks..."
cd "$REPO_ROOT/apps/frontend"
npm run lint:fix
npm run test:unit
npm run test:e2e:headless
npm run typecheck

# Run schema pre-push
echo "→ Running schema checks..."
cd "$REPO_ROOT/apps/schema"
npm run lint:fix
# npm run test:unit
npm run typecheck

echo "✓ Pre-push checks passed"
